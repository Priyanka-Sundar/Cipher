<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Cipher Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
  body{display:flex; justify-content:center; align-items:center; height:100vh; background:#ffe4f1;}
  .login-box{
    background:#fff0f6; 
    border:3px solid #ff99c8; 
    padding:30px; 
    text-align:center; 
    border-radius:8px; 
    width:360px; /* increased width */
    box-sizing:border-box;
  }
  .login-box input{
    width:90%; 
    margin:8px 0; 
    padding:6px; 
    border:2px solid #ff99c8; 
    border-radius:6px;
  }
  .login-box .btn{
    background:#ff99c8; 
    color:white; 
    border:none; 
    padding:8px 12px; 
    cursor:pointer; 
    border-radius:6px;
  }
  .switch-page{
    margin-top:12px; 
    font-size:8px; 
    color:#e0559d; 
    cursor:pointer; 
    text-decoration:underline;
  }
</style>

</head>
<body>
  <div class="login-box">
    <h2>Login to Cipher</h2>
    <input type="text" id="username" placeholder="Username"><br>
    <input type="password" id="password" placeholder="Password"><br>
    <button class="btn" id="loginBtn">Login</button>
    <p id="loginFeedback" style="font-size:10px; color:#e0559d;"></p>
    <div class="switch-page" onclick="window.location.href='signup.html'">Don't have an account? Sign Up</div>
  </div>

  <script>
    const loginBtn = document.getElementById('loginBtn');
    const feedback = document.getElementById('loginFeedback');

    loginBtn.addEventListener('click',()=>{
      const user = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value.trim();
      if(!user || !pass){
        feedback.textContent = "Enter username & password";
        return;
      }

      const users = JSON.parse(localStorage.getItem('cipher_users')||'{}');
      if(!users[user]){ feedback.textContent="User not found"; return; }
      if(users[user].password !== pass){ feedback.textContent="Wrong password"; return; }

      // Login success
      localStorage.setItem('cipher_current_user', user);
      // Update streaks
      const today = new Date().toDateString();
      if(users[user].lastLogin !== today){
        if(users[user].lastLogin === new Date(Date.now()-86400000).toDateString()){
          users[user].streak = (users[user].streak||0)+1;
        } else { users[user].streak = 1; }
        users[user].lastLogin = today;
      }
      localStorage.setItem('cipher_users', JSON.stringify(users));
      window.location.href = "index.html";
    });

    // Auto-register a demo user if not exists
    const users = JSON.parse(localStorage.getItem('cipher_users')||'{}');
    if(!users['demo']){
      users['demo']={password:'demo123', streak:0, lastLogin:'', profilePic:''};
      localStorage.setItem('cipher_users', JSON.stringify(users));
    }
  </script>
</body>
</html>
